webpackJsonp([20],{ghPd:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Gu7T"),n=r.n(a),s=r("Xxa5"),o=r.n(s),i=r("exGp"),c=r.n(i),p=r("zLZ9"),d=r.n(p),l={components:{isDeleteDialog:r("wxRv").a},data:function(){return{visible:!1,dictionaryColumns:d.a.data.attList,groups:[],id:"",deleteItem:""}},created:function(){this.id=this.$route.query.id,this.getProperty()},methods:{save:function(e,t){var r=this;return c()(o.a.mark(function a(){var n,s;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n={propertyDesc:e.propertyDesc,propertyName:e.propertyName,propertyCode:e.propertyCode,propertyId:e.propertyId?r.propertyId:"",deviceTypeId:r.id,parentId:t.propertyId,operatorId:JSON.parse(localStorage.getItem("usermsg")).accountId},a.next=3,r.$http.post(r.$api.propertyform,n);case 3:1e4==(s=a.sent).data.resultCode?(r.$message.success(s.data.resultMsg),r.getProperty()):r.$message.error(s.data.resultMsg);case 5:case"end":return a.stop()}},a,r)}))()},cancel:function(e){var t=this;return c()(o.a.mark(function r(){var a,n;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a={propertyId:e.propertyId},r.next=3,t.$http.post(t.$api.propertyremove,a);case 3:1e4==(n=r.sent).data.resultCode?(t.$message.success(n.data.resultMsg),t.getProperty()):t.$message.error(n.data.resultMsg);case 5:case"end":return r.stop()}},r,t)}))()},add:function(){this.groups.push({})},addGroupAtt:function(e){this.groups[e].childrenList.push({propertyCode:"",propertyId:"",propertyName:"",propertyDesc:""})},deleteGroup:function(e){this.deleteItem=e,this.visible=!0},getProperty:function(){var e=this;return c()(o.a.mark(function t(){var r,a,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={deviceTypeId:e.id},t.next=3,e.$http.post(e.$api.propertylist,r);case 3:1e4==(a=t.sent).data.resultCode?(n=[],a.data.data.result.forEach(function(e){"100000000000000000000000000000000000000000000000000000000000"==e.parentId&&(e.childrenList=[],a.data.data.result.forEach(function(t){t.parentId==e.propertyId&&e.childrenList.push(t)}),n.push(e))}),e.groups=n):(e.groups.push({}),e.$message.error(a.data.resultMsg));case 5:case"end":return t.stop()}},t,e)}))()},saveGroup:function(e){var t=this;return c()(o.a.mark(function r(){var a,n;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e.propertyName){r.next=3;break}return t.$message.warning("属性分组名称不能为空"),r.abrupt("return");case 3:return a={propertyName:e.propertyName,deviceTypeId:t.id,operatorId:JSON.parse(localStorage.getItem("usermsg")).accountId},r.next=6,t.$http.post(t.$api.propertyform,a);case 6:1e4==(n=r.sent).data.resultCode?(t.getProperty(),t.$message.success(n.data.resultMsg)):t.$message.error(n.data.resultMsg);case 8:case"end":return r.stop()}},r,t)}))()},handleChange:function(e,t,r,a){var s=[].concat(n()(this.groups)),o=s[a].childrenList[t];o&&(o[r]=e,this.groups=s)},confirmDialog:function(){var e=this;return c()(o.a.mark(function t(){var r,a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.visible=!1,r={propertyId:e.deleteItem.propertyId},t.next=4,e.$http.post(e.$api.propertyremove,r);case 4:1e4==(a=t.sent).data.resultCode?(e.$message.success(a.data.resultMsg),e.getProperty()):e.$message.error(a.data.resultMsg);case 6:case"end":return t.stop()}},t,e)}))()},cancleDialog:function(){this.visible=!1}}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"content2"},[e._l(e.groups,function(t,a){return r("div",{key:a,staticClass:"flexcolumn"},[r("div",{staticClass:"flexrow flexac",staticStyle:{"margin-top":"10px","margin-bottom":"10px"}},[e._m(0,!0),e._v(" "),r("a-input",{staticClass:"edit_a_input",attrs:{placeholder:"注：50字以内，中文汉字、英文字母、数字、英文下划线、中英文小括号"},model:{value:t.propertyName,callback:function(r){e.$set(t,"propertyName",r)},expression:"item.propertyName"}}),e._v(" "),r("a-button",{staticClass:"top-btn",attrs:{type:"primary"},on:{click:function(r){return e.saveGroup(t)}}},[e._v("保存")]),e._v(" "),r("a-button",{staticClass:"top-btn",attrs:{disabled:!t.propertyId},on:{click:function(t){return e.addGroupAtt(a)}}},[e._v("新增属性")]),e._v(" "),r("a-button",{staticClass:"top-btn",attrs:{disabled:!t.propertyId},on:{click:function(r){return e.deleteGroup(t)}}},[e._v("删除")])],1),e._v(" "),t.childrenList&&t.childrenList.length>0?r("a-table",{staticStyle:{"margin-top":"20px","margin-bottom":"20px"},attrs:{columns:e.dictionaryColumns,"data-source":t.childrenList,pagination:!1,bordered:!0,size:"small"},scopedSlots:e._u([{key:"index",fn:function(t,a,n){return[r("div",[e._v(e._s(n+1))])]}},e._l(["propertyName","propertyCode","propertyDesc"],function(t){return{key:t,fn:function(n,s,o){return[r("div",{key:t},[r("a-input",{staticStyle:{margin:"-5px 0",border:"0px"},attrs:{value:n},on:{change:function(r){return e.handleChange(r.target.value,o,t,a)}}})],1)]}}}),{key:"operation",fn:function(a,n,s){return[r("div",{staticClass:"flexrow flexjc"},[r("a",{on:{click:function(){return e.save(n,t)}}},[e._v("保存")]),e._v(" "),r("div",{staticClass:"item-line"}),e._v(" "),n.hasValueNum<=0?r("a-popconfirm",{attrs:{title:"确定删除数值吗?"},on:{confirm:function(){return e.cancel(n)}}},[r("a",{staticStyle:{color:"#FF0033"}},[e._v("删除")])]):r("a",{staticStyle:{color:"#DCDCDC"}},[e._v("删除")])],1)]}}],null,!0)}):e._e()],1)}),e._v(" "),r("div",{staticClass:"flexrow flexjc flexac addbtn",on:{click:e.add}},[r("a-icon",{staticStyle:{"margin-right":"5px"},attrs:{"two-tone-color":"#ffffff",type:"plus"}}),e._v(" 新增分组\n  ")],1),e._v(" "),e.visible?r("is-delete-dialog",{on:{confirm:e.confirmDialog,cancle:e.cancelDialog}}):e._e()],2)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"edit_item_title3"},[t("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("属性分组:")])}]};var m=r("VU/8")(l,u,!1,function(e){r("jokM")},null,null);t.default=m.exports},jokM:function(e,t){},zLZ9:function(e,t){e.exports={data:{dictionaryColumns:[{title:"序号",width:"80px",align:"center",ellipsis:!0,scopedSlots:{customRender:"index"}},{title:"类型名称",align:"center",dataIndex:"deviceTypeName",ellipsis:!0},{title:"类型代码",align:"center",dataIndex:"deviceTypeCode",ellipsis:!0},{title:"业务类别",align:"center",dataIndex:"serviceTypeName",ellipsis:!0},{title:"品牌数量",align:"center",dataIndex:"brandTotal",ellipsis:!0},{title:"型号数量",align:"center",dataIndex:"modelTotal",ellipsis:!0},{title:"操作",align:"center",width:"360px",scopedSlots:{customRender:"operation"}}],adddictionaryColumns:[{title:"序号",width:"80px",align:"center",scopedSlots:{customRender:"index"}},{title:"品牌名称",dataIndex:"brandName",align:"center"},{title:"品牌代码",dataIndex:"brandCode",align:"center"}],attList:[{title:"序号",width:"3%",align:"center",scopedSlots:{customRender:"index"}},{title:"属性名称",dataIndex:"propertyName",align:"center",width:"15%",scopedSlots:{customRender:"propertyName"}},{title:"属性代码",dataIndex:"propertyCode",align:"center",width:"15%",scopedSlots:{customRender:"propertyCode"}},{title:"属性描述",dataIndex:"propertyDesc",align:"center",width:"40%",scopedSlots:{customRender:"propertyDesc"}},{title:"操作",dataIndex:"brandCode",align:"center",width:"25%",scopedSlots:{customRender:"operation"}}]}}}});