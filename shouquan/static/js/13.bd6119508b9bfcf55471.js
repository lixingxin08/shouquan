webpackJsonp([13],{"1gyD":function(t,e){},"4Mtj":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("Gu7T"),a=s.n(i),n=s("Xxa5"),o=s.n(n),r=s("exGp"),c=s.n(r),l=s("5P0m"),d=s.n(l),m={data:function(){return{current:0,stepStyle:{marginBottom:"60px",boxShadow:"0px -1px 0 0 #e8e8e8 inset"},steps:[{title:"短信账号",status:"0"},{title:"消息模板",status:"1"}],smsTypeList:[],addcolumns:d.a.data.adddColumns,msgList:[],config:{typeCode:0},id:null,num:0}},created:function(){this.id=this.$route.query.id,this.id?this.getSmsInfo():this.getSmsMsgList(),this.getCombobox()},methods:{onChange:function(t){if(1==t){if(!this.config.smsConfigName)return void this.$message.warning("请先填写短信账号别名");if(!this.config.smsAppId)return void this.$message.warning("请先填写短信应用标识");if(!this.config.smsKey)return void this.$message.warning("请先填写短信应用密钥");if(!this.config.signName)return void this.$message.warning("请先填写短信签名");if(!this.config.price)return void this.$message.warning("请先填写短信价格");if(!this.config.typeCode)return void this.$message.warning("请先选则短信账号类型")}this.current=t},submit:function(){var t=this;return c()(o.a.mark(function e(){var s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.checkMsgList()){e.next=3;break}return t.$message.warning("消息服务序号不能有重复值"),e.abrupt("return");case 3:return t.config.operatorId=JSON.parse(localStorage.getItem("usermsg")).accountId,t.config.smsModelList=t.msgList,e.next=7,t.$http.post(t.$api.smsform,t.config);case 7:1e4==(s=e.sent).data.resultCode?(t.id||t.$router.go(-1),t.$message.success(s.data.resultMsg)):t.$message.error(s.data.resultMsg);case 9:case"end":return e.stop()}},e,t)}))()},getSmsInfo:function(){var t=this;return c()(o.a.mark(function e(){var s,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s={smsConfigId:t.id},e.next=3,t.$http.post(t.$api.smsdetail,s);case 3:1e4==(i=e.sent).data.resultCode&&(t.config=i.data.data,t.msgList=i.data.data.smsModelList);case 5:case"end":return e.stop()}},e,t)}))()},getSmsMsgList:function(){var t=this;return c()(o.a.mark(function e(){var s,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s={classCode:"sms_push_template"},e.next=3,t.$http.post(t.$api.dictionarycombobox,s);case 3:1e4==(i=e.sent).data.resultCode&&i.data.data.forEach(function(e){t.msgList.push({serviceId:"",modelCode:e.comboBoxId,remark:e.comboBoxName})});case 5:case"end":return e.stop()}},e,t)}))()},checkMsgList:function(){var t=[],e=!1;return this.msgList.forEach(function(s){t.indexOf(s.serviceId)>=0?e=!0:t.push(s.serviceId)}),e},handleChange:function(t,e){var s=[].concat(a()(this.msgList)),i=s[e];i&&(i.serviceId=t,this.msgList=s)},handleSelectChange:function(t){console.log(t),this.config.typeCode=t},getCombobox:function(){var t=this;return c()(o.a.mark(function e(){var s,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s={classCode:"message_type_sms"},e.next=3,t.$http.post(t.$api.dictionarycombobox,s);case 3:1e4==(i=e.sent).data.resultCode&&(t.smsTypeList=i.data.data);case 5:case"end":return e.stop()}},e,t)}))()},reset:function(){this.current=0,this.id?this.getWeChatInfo():this.config={}},onChangeConfig:function(){this.num=this.config.remark.length}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flexcolumn",staticStyle:{"background-color":"#FFFFFF"}},[s("div",{staticStyle:{margin:"0 auto"}},[s("a-steps",{attrs:{current:t.current,type:"navigation"},on:{change:t.onChange}},t._l(t.steps,function(t){return s("a-step",{key:t.status,attrs:{title:t.title}})}),1),t._v(" "),0==t.current?s("div",[s("div",{staticClass:"flexrow flexac edit_item_sms"},[t._m(0),t._v(" "),s("a-input",{staticClass:"edit_a_input_sms",attrs:{placeholder:"50字以内，支持中英文"},model:{value:t.config.smsConfigName,callback:function(e){t.$set(t.config,"smsConfigName",e)},expression:"config.smsConfigName"}})],1),t._v(" "),s("div",{staticClass:"flexrow flexac edit_item_sms"},[t._m(1),t._v(" "),s("a-input",{staticClass:"edit_a_input_sms",attrs:{placeholder:"50字以内，中文汉字、英文字母、数字、英文下划线、中英文小括号"},model:{value:t.config.smsAppId,callback:function(e){t.$set(t.config,"smsAppId",e)},expression:"config.smsAppId"}})],1),t._v(" "),s("div",{staticClass:"flexrow flexac edit_item_sms"},[t._m(2),t._v(" "),s("a-input",{staticClass:"edit_a_input_sms",attrs:{placeholder:"50字以内，中文汉字、英文字母、数字、英文下划线、中英文小括号"},model:{value:t.config.smsKey,callback:function(e){t.$set(t.config,"smsKey",e)},expression:"config.smsKey"}})],1),t._v(" "),s("div",{staticClass:"flexrow flexac edit_item_sms"},[t._m(3),t._v(" "),s("a-input",{staticClass:"edit_a_input_sms",attrs:{placeholder:"50字以内，中文汉字、英文字母、数字、英文下划线、中英文小括号"},model:{value:t.config.signName,callback:function(e){t.$set(t.config,"signName",e)},expression:"config.signName"}})],1),t._v(" "),s("div",{staticClass:"flexrow flexac edit_item_sms"},[t._m(4),t._v(" "),s("a-input-number",{staticClass:"edit_a_input_sms",attrs:{placeholder:"50字以内，中文汉字、英文字母、数字、英文下划线、中英文小括号"},model:{value:t.config.price,callback:function(e){t.$set(t.config,"price",e)},expression:"config.price"}}),t._v(" "),s("div",{staticClass:"edit_item_sms_toast"},[t._v("分/条")])],1),t._v(" "),s("div",{staticClass:"flexrow flexac edit_item_sms"},[t._m(5),t._v(" "),s("a-select",{staticStyle:{width:"667px"},attrs:{value:t.config.typeCode?t.config.typeCode:"请选择短信账号类型"},on:{change:t.handleSelectChange}},t._l(t.smsTypeList,function(e,i){return s("a-select-option",{key:i,attrs:{value:e.comboBoxId}},[t._v("\n            "+t._s(e.comboBoxName)+"\n          ")])}),1)],1),t._v(" "),s("div",{staticClass:"flexrow flexac edit_item_sms"},[s("div",{staticClass:"edit_item_sms_title2_sms"},[t._v("备注信息:")]),t._v(" "),s("div",{staticStyle:{position:"relative"}},[s("a-textarea",{staticClass:"edit_a_input_sms",attrs:{rows:5,maxLength:250,placeholder:"请输入描述"},on:{change:t.onChangeConfig},model:{value:t.config.remark,callback:function(e){t.$set(t.config,"remark",e)},expression:"config.remark"}}),t._v(" "),s("div",{staticClass:"edit_number_sms"},[t._v(t._s(t.num)+"/250")])],1)])]):s("a-table",{staticStyle:{"margin-top":"20px","margin-bottom":"20px"},attrs:{scroll:{x:820},columns:t.addcolumns,"data-source":t.msgList,pagination:!1,bordered:!0,size:"small"},scopedSlots:t._u([{key:"index",fn:function(e,i,a){return[s("div",[t._v(t._s(a+1))])]}},{key:"serviceId",fn:function(e,i,a){return[s("a-input",{staticStyle:{margin:"-5px 0",border:"0px"},on:{change:function(e){return t.handleChange(e.target.value,a)}},model:{value:e,callback:function(t){e=t},expression:"text"}})]}}])}),t._v(" "),s("div",{staticClass:"flexrow flexjc",staticStyle:{"margin-top":"60px","margin-bottom":"100px"}},[1==t.current?s("a-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("保存")]):t._e(),t._v(" "),0==t.current?s("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.onChange(1)}}},[t._v("下一步")]):t._e(),t._v(" "),s("a-button",{staticStyle:{"margin-left":"60px"},on:{click:t.reset}},[t._v("重置")])],1)],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"edit_item_sms_title2_sms"},[e("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("短信账号别名:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"edit_item_sms_title2_sms"},[e("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("帐号应用标识:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"edit_item_sms_title2_sms"},[e("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("帐号应用密钥:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"edit_item_sms_title2_sms"},[e("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("短信签名:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"edit_item_sms_title2_sms"},[e("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("短信价格:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"edit_item_sms_title2_sms"},[e("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("网关类型:")])}]};var _=s("VU/8")(m,u,!1,function(t){s("1gyD")},null,null);e.default=_.exports},"5P0m":function(t,e){t.exports={data:{dictionaryColumns:[{title:"序号",width:"80px",align:"center",ellipsis:!0,scopedSlots:{customRender:"index"}},{title:"微信账号别名",align:"center",dataIndex:"wechatConfigName",ellipsis:!0},{title:"账号应用标识",align:"center",dataIndex:"wechatAppId",ellipsis:!0},{title:"令牌过期时间",align:"center",dataIndex:"expirationTime",ellipsis:!0},{title:"微信账号类型",align:"center",dataIndex:"typeCode",ellipsis:!0},{title:"操作",align:"center",width:"320px",scopedSlots:{customRender:"operation"}}],adddColumns:[{title:"序号",scopedSlots:{customRender:"index"},width:"5%",align:"center"},{title:"消息模板代码",dataIndex:"modelCode",width:"20%",align:"center",scopedSlots:{customRender:"modelCode"}},{title:"消息模板内容",dataIndex:"remark",width:"20%",align:"center",scopedSlots:{customRender:"remark"}},{title:"消息服务序号",dataIndex:"serviceId",width:"20%",align:"center",scopedSlots:{customRender:"serviceId"}}]}}}});