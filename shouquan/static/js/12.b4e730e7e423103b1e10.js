webpackJsonp([12],{WYmg:function(t,e){},X4kS:function(t,e){t.exports={data:{dictionaryColumns:[{title:"序号",width:"80px",align:"center",ellipsis:!0,scopedSlots:{customRender:"index"}},{title:"微信账号别名",align:"center",dataIndex:"wechatConfigName",ellipsis:!0},{title:"账号应用标识",align:"center",dataIndex:"wechatAppId",ellipsis:!0},{title:"令牌过期时间",align:"center",dataIndex:"expirationTime",ellipsis:!0},{title:"微信账号类型",align:"center",dataIndex:"typeCode",ellipsis:!0},{title:"操作",align:"center",width:"320px",scopedSlots:{customRender:"operation"}}],adddColumns:[{title:"序号",scopedSlots:{customRender:"index"},width:"5%",className:"topic-info",align:"center"},{title:"消息模板代码",dataIndex:"modelCode",width:"20%",align:"center",className:"topic-info",scopedSlots:{customRender:"modelCode"}},{title:"消息模板内容",dataIndex:"remark",width:"20%",align:"center",className:"topic-info",scopedSlots:{customRender:"remark"}},{title:"消息服务序号",dataIndex:"serviceId",width:"20%",align:"center",scopedSlots:{customRender:"serviceId"}}]}}},lg8A:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Gu7T"),s=a.n(i),c=a("Xxa5"),n=a.n(c),r=a("exGp"),o=a.n(r),l=a("X4kS"),d=a.n(l),h={data:function(){return{current:0,stepStyle:{marginBottom:"60px",boxShadow:"0px -1px 0 0 #e8e8e8 inset"},steps:[{title:"微信账号",status:"0"},{title:"消息模板",status:"1"}],wetchatTypeList:[],addcolumns:d.a.data.adddColumns,wechatSelect:"",msgList:[],wechat:{typeCode:""},id:null,num:0}},created:function(){this.id=this.$route.query.id,this.id?this.getWeChatInfo():this.getWeChatMsgList(),this.getCombobox()},methods:{onChange:function(t){if(1==t){if(!this.wechat.wechatConfigName)return void this.$message.success("请先填写微信账号别名");if(!this.wechat.wechatAppId)return void this.$message.warning("请先填写微信应用标识");if(!this.wechat.wechatKey)return void this.$message.warning("请先填写微信应用密钥");if(!this.wechat.typeCode)return void this.$message.warning("请先选则微信账号类型")}this.current=t},submit:function(){var t=this;return o()(n.a.mark(function e(){var a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.checkMsgList()){e.next=3;break}return t.$message.warning("消息服务序号不能有重复值"),e.abrupt("return");case 3:return a={wechatConfigId:t.id,wechatConfigName:t.wechat.wechatConfigName,wechatAppId:t.wechat.wechatAppId,wechatKey:t.wechat.wechatKey,tokenCode:t.wechat.tokenCode,expirationTime:t.wechat.expirationTime,typeCode:t.wechat.typeCode,operatorId:"5172dadd6d7c404e8ac657f32f81d969",remark:t.wechat.remark,modelList:t.msgList},e.next=6,t.$http.post(t.$api.wechatform,a);case 6:1e4==(i=e.sent).data.resultCode?(t.id||t.$router.go(-1),t.$message.success(i.data.resultMsg)):t.$message.error(i.data.resultMsg);case 8:case"end":return e.stop()}},e,t)}))()},getWeChatInfo:function(){var t=this;return o()(n.a.mark(function e(){var a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={wechatConfigId:t.id},e.next=3,t.$http.post(t.$api.wechatdetail,a);case 3:1e4==(i=e.sent).data.resultCode&&(t.wechat=i.data.data,t.msgList=i.data.data.modelList);case 5:case"end":return e.stop()}},e,t)}))()},getWeChatMsgList:function(){var t=this;return o()(n.a.mark(function e(){var a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={classCode:"wechat_push_template"},e.next=3,t.$http.post(t.$api.dictionarycombobox,a);case 3:1e4==(i=e.sent).data.resultCode&&i.data.data.forEach(function(e){t.msgList.push({serviceId:"",modelCode:e.comboBoxId,remark:e.comboBoxName})});case 5:case"end":return e.stop()}},e,t)}))()},checkMsgList:function(){var t=[],e=!1;return this.msgList.forEach(function(a){t.indexOf(a.serviceId)>=0?e=!0:t.push(a.serviceId)}),e},handleChange:function(t,e){var a=[].concat(s()(this.msgList)),i=a[e];i&&(i.serviceId=t,this.msgList=a)},handleSelectChange:function(t){console.log(t),this.wechat.typeCode=t},getCombobox:function(){var t=this;return o()(n.a.mark(function e(){var a,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={classCode:"message_type_wechat"},e.next=3,t.$http.post(t.$api.dictionarycombobox,a);case 3:1e4==(i=e.sent).data.resultCode&&(t.wetchatTypeList=i.data.data);case 5:case"end":return e.stop()}},e,t)}))()},reset:function(){this.current=0,this.id?this.getWeChatInfo():this.wechat={}},onChangeConfig:function(){this.num=this.wechat.remark.length}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flexcolumn",staticStyle:{"background-color":"#FFFFFF"}},[a("div",{staticStyle:{margin:"0 auto"}},[a("a-steps",{attrs:{current:t.current,type:"navigation"},on:{change:t.onChange}},t._l(t.steps,function(t){return a("a-step",{key:t.status,attrs:{title:t.title}})}),1),t._v(" "),0==t.current?a("div",[a("div",{staticClass:"flexrow flexac edit_item_wechat"},[t._m(0),t._v(" "),a("a-input",{staticClass:"edit_a_input_wechat",attrs:{placeholder:"50字以内，支持中英文"},model:{value:t.wechat.wechatConfigName,callback:function(e){t.$set(t.wechat,"wechatConfigName",e)},expression:"wechat.wechatConfigName"}})],1),t._v(" "),a("div",{staticClass:"flexrow flexac edit_item_wechat"},[t._m(1),t._v(" "),a("a-input",{staticClass:"edit_a_input_wechat",attrs:{placeholder:"50字以内，中文汉字、英文字母、数字、英文下划线、中英文小括号"},model:{value:t.wechat.wechatAppId,callback:function(e){t.$set(t.wechat,"wechatAppId",e)},expression:"wechat.wechatAppId"}})],1),t._v(" "),a("div",{staticClass:"flexrow flexac edit_item_wechat"},[t._m(2),t._v(" "),a("a-input",{staticClass:"edit_a_input_wechat",attrs:{placeholder:"50字以内，中文汉字、英文字母、数字、英文下划线、中英文小括号"},model:{value:t.wechat.wechatKey,callback:function(e){t.$set(t.wechat,"wechatKey",e)},expression:"wechat.wechatKey"}})],1),t._v(" "),t.id?a("div",{staticClass:"flexrow flexac edit_item_wechat"},[t._m(3),t._v(" "),a("a-input",{staticClass:"edit_a_input_wechat",attrs:{placeholder:"50字以内，中文汉字、英文字母、数字、英文下划线、中英文小括号"},model:{value:t.wechat.tokenCode,callback:function(e){t.$set(t.wechat,"tokenCode",e)},expression:"wechat.tokenCode"}})],1):t._e(),t._v(" "),t.id?a("div",{staticClass:"flexrow flexac edit_item_wechat"},[t._m(4),t._v(" "),a("a-input",{staticClass:"edit_a_input_wechat",attrs:{placeholder:"50字以内，中文汉字、英文字母、数字、英文下划线、中英文小括号"},model:{value:t.wechat.expirationTime,callback:function(e){t.$set(t.wechat,"expirationTime",e)},expression:"wechat.expirationTime"}})],1):t._e(),t._v(" "),a("div",{staticClass:"flexrow flexac edit_item_wechat"},[t._m(5),t._v(" "),a("a-select",{staticStyle:{width:"667px"},attrs:{value:t.wechat.typeCode?t.wechat.typeCode:"请选择微信账号类型"},on:{change:t.handleSelectChange}},t._l(t.wetchatTypeList,function(e,i){return a("a-select-option",{key:i,attrs:{value:e.comboBoxId}},[t._v("\n            "+t._s(e.comboBoxName)+"\n          ")])}),1)],1),t._v(" "),a("div",{staticClass:"flexrow flexac edit_item_wechat"},[a("div",{staticClass:"edit_item_wechat_title2_wechat"},[t._v("备注信息:")]),t._v(" "),a("div",{staticStyle:{position:"relative"}},[a("a-textarea",{staticClass:"edit_a_input_wechat",attrs:{rows:5,maxLength:250,placeholder:"请输入描述"},on:{change:t.onChangeConfig},model:{value:t.wechat.remark,callback:function(e){t.$set(t.wechat,"remark",e)},expression:"wechat.remark"}}),t._v(" "),a("div",{staticClass:"edit_number_wechat"},[t._v(t._s(t.num)+"/250")])],1)])]):a("a-table",{staticStyle:{"margin-top":"20px","margin-bottom":"20px"},attrs:{scroll:{x:820},columns:t.addcolumns,"data-source":t.msgList,pagination:!1,bordered:!0,size:"small"},scopedSlots:t._u([{key:"index",fn:function(e,i,s){return[a("div",[t._v(t._s(s+1))])]}},{key:"serviceId",fn:function(e,i,s){return a("a-input",{staticStyle:{margin:"-5px 0",border:"0px"},on:{change:function(e){return t.handleChange(e.target.value,s)}},model:{value:e,callback:function(t){e=t},expression:"text"}})}}])}),t._v(" "),a("div",{staticClass:"flexrow flexjc",staticStyle:{"margin-top":"60px","margin-bottom":"100px"}},[1==t.current?a("a-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("保存")]):t._e(),t._v(" "),0==t.current?a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.onChange(1)}}},[t._v("下一步")]):t._e(),t._v(" "),a("a-button",{staticStyle:{"margin-left":"60px"},on:{click:t.reset}},[t._v("重置")])],1)],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"edit_item_wechat_title2_wechat"},[e("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("微信账号别名:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"edit_item_wechat_title2_wechat"},[e("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("帐号应用标识:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"edit_item_wechat_title2_wechat"},[e("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("帐号应用密钥:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"edit_item_wechat_title2_wechat"},[e("a",{staticStyle:{color:"#FF0000"}}),this._v("接口通行令牌:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"edit_item_wechat_title2_wechat"},[e("a",{staticStyle:{color:"#FF0000"}}),this._v("令牌失效时间:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"edit_item_wechat_title2_wechat"},[e("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("微信账号类型:")])}]};var p=a("VU/8")(h,u,!1,function(t){a("WYmg")},null,null);e.default=p.exports}});