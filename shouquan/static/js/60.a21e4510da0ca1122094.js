webpackJsonp([60],{"/FWb":function(t,e){},zNsT:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Xxa5"),s=a.n(r),i=a("exGp"),n=a.n(i),d={inject:["reload"],components:{isLeft:a("vP0l").a},data:function(){var t=this;return{tablecolumns:[{width:58,align:"center",title:"序号",dataIndex:"customerId",key:"customerId",ellipsis:!0},{width:141,align:"center",title:"客户简称",dataIndex:"shortName",key:"shortName",ellipsis:!0},{width:141,align:"center",title:"客户状态",dataIndex:"statusCode",key:"statusCode 1",ellipsis:!0,scopedSlots:{customRender:"statusCode"}}],tabledata:[],issearchdata:"",treedata:"",filterdata:[],oldtreedata:"",replaceFields:{title:"name",key:"id"},defaultExpandedKeys:[],data:"",showtree:!1,tabletype:!1,treeprame:{customerId:"",operatorId:""},runpageparam:{statusCode:"",keyword:"",accountId:"",operatorId:"1",pageIndex:1,pageSize:10},istotal:{type:1},form:[],ischeck:[],remark:"",listparam:{operatorId:"1",customerId:""},customerId:"",rowClick:function(e){return{on:{click:function(){t.customerId=e.customerId,console.log(e,"record",t.customerId)}}}}}},created:function(){this.getlist(),this.gettree()},methods:{getlist:function(){var t=this;return n()(s.a.mark(function e(){var a,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.tabletype=!1,e.next=3,t.$http.post(t.$api.customeraccountmylist,t.listparam);case 3:if(a=e.sent,console.log(a,555555),"10000"!=a.data.resultCode){e.next=13;break}for(r=0;r<a.data.data.length;r++)1==a.data.data[r].statusCode&&t.tabledata.push(a.data.data[r]);t.customerId=t.tabledata[0].customerId,t.form.customerId=t.tabledata[0].customerId,t.istotal.type++,t.tabletype=!0,e.next=14;break;case 13:return e.abrupt("return",t.$message.error(a.data.resultMsg));case 14:case"end":return e.stop()}},e,t)}))()},getform:function(){var t=this;return n()(s.a.mark(function e(){var a,r,i,n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a={customerId:"",areaId:"",areaName:"",grade:"",parentId:"",remark:"",operatorId:"1"},0!=t.ischeck.length){e.next=3;break}return e.abrupt("return",t.$message.error("请选择授权区域"));case 3:if(""!=t.customerId){e.next=5;break}return e.abrupt("return",t.$message.error("请选择授权客户"));case 5:for(r=0;r<t.ischeck.length;r++)for(i=0;i<t.data.length;i++)t.ischeck[r]==t.data[i].id&&(t.form.push(a),t.form[r].customerId=t.customerId,t.form[r].areaId=t.data[i].id,t.form[r].areaName=t.data[i].name,t.form[r].grade=t.data[i].levelType,t.form[r].parentId=t.data[i].pid,t.form[r].remark=t.remark);return e.next=8,t.$http.post(t.$api.customerareaform,t.form);case 8:if("10000"!=(n=e.sent).data.resultCode){e.next=13;break}t.$message.error("授权成功"),e.next=14;break;case 13:return e.abrupt("return",t.$message.error(n.data.resultMsg));case 14:case"end":return e.stop()}},e,t)}))()},gettree:function(){var t=this;return n()(s.a.mark(function e(){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.showtree=!1,e.next=3,t.$http.post(t.$api.customerareatree,t.treeprame);case 3:if("10000"!=(a=e.sent).data.resultCode){e.next=8;break}t.data=a.data.data,e.next=9;break;case 8:return e.abrupt("return",t.$message.error(a.data.resultMsg));case 9:t.setdata(),t.showtree=!0;case 11:case"end":return e.stop()}},e,t)}))()},toTree:function(t){var e=[];if(!Array.isArray(t))return e;t.forEach(function(t){delete t.children});var a={};return t.forEach(function(t){a[t.id]=t}),t.forEach(function(t){var r=a[t.pid];r?(r.children||(r.children=[])).push(t):e.push(t)}),e},setdata:function(){for(var t=0;t<this.data.length;t++)1==this.data[t].open&&this.defaultExpandedKeys.push(this.data[t].id);this.treedata=this.toTree(this.data),this.oldtreedata=this.treedata},searchtree:function(){if(this.treedata=this.oldtreedata,""!=this.issearchdata){var t=this.oldtreedata;this.setfilltertree(t)}},setfilltertree:function(t){for(var e in t){-1!=(t[e].name+"").search(this.issearchdata)&&(this.filterdata.push(t[e]),console.log(this.filterdata,22222)),t[e].children&&this.setfilltertree(t[e].children)}console.log(this.filtersdata,111111),this.treedata=this.toTree(this.filterdata)},getselectdata:function(t){this.isselectdata=t,this.isselectdata.id=t.id,this.isselectdata.name=t.name,this.isselectdata.pid=t.pid,this.istotal.type=1},getcheckedKeys:function(t){console.log(t,44444),this.ischeck=t},cancel:function(){this.reload()}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"flex_f father"},[a("div",{staticClass:"isleft"},[a("div",{staticClass:"left_title"},[t._v("客户列表")]),t._v(" "),a("a-table",{attrs:{columns:t.tablecolumns,"data-source":t.tabledata,bordered:"",pagination:!1,customRow:t.rowClick},scopedSlots:t._u([{key:"statusCode",fn:function(e){return a("div",{staticClass:"flex_a"},[1==e?a("div",[t._v("启用")]):t._e(),t._v(" "),2==e?a("div",[t._v("备用")]):t._e(),t._v(" "),0==e?a("div",[t._v("关闭")]):t._e()])}}])})],1),t._v(" "),a("div",{staticClass:"isright"},[a("div",{staticClass:"r_t flex_f"},[a("div",[t._v("区划名称:")]),t._v(" "),a("div",[a("a-input",{staticClass:"r_t_inp",attrs:{placeholder:"请输入区划名称"},model:{value:t.issearchdata,callback:function(e){t.issearchdata=e},expression:"issearchdata"}})],1),t._v(" "),a("div",{staticClass:"btn_blue btn",on:{click:function(e){return t.searchtree()}}},[t._v("查询")])]),t._v(" "),a("div",{staticClass:"tree_box_zon"},[t.showtree?a("is-left",{attrs:{treedata:t.treedata,replaceFields:t.replaceFields,defaultExpandedKeys:t.defaultExpandedKeys},on:{checkedKeys:t.getcheckedKeys}}):t._e()],1),t._v(" "),a("div",{staticClass:"r_b"},[a("div",{staticClass:"r_b_title"},[t._v("授权描述:")]),t._v(" "),a("div",{staticClass:"rb_text"},[a("a-textarea",{attrs:{placeholder:"Basic usage",rows:5},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}})],1),t._v(" "),a("div",{staticClass:"flex_a rb_b"},[a("div",{staticClass:"flex_f"},[a("div",{staticClass:"cancel_btn rb_b_btn",on:{click:function(e){return t.cancel()}}},[t._v("取消")]),t._v(" "),a("div",{staticClass:"ok_btn",on:{click:function(e){return t.getform()}}},[t._v("授权")])])])])])])},staticRenderFns:[]};var o=a("VU/8")(d,c,!1,function(t){a("/FWb")},"data-v-07006920",null);e.default=o.exports}});