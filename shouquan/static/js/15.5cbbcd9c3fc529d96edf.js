webpackJsonp([15],{bxUj:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Xxa5"),i=a.n(s),n=a("exGp"),r=a.n(n),c=a("zLZ9"),l=a.n(c),o={data:function(){return{selectDefault:"请选择业务类别",selectList:[],brandList:[],dictionaryColumns:l.a.data.adddictionaryColumns,typeName:"",typeCode:"",remark:"",num:0,selectedRowKeys:[],deviceId:""}},created:function(){this.deviceId=this.$route.query.id,this.getCombobox(),this.deviceId?this.getDeviceInfo():this.getBrandData()},methods:{onChangeConfig:function(e){this.num=this.remark.length},getDeviceInfo:function(){var e=this;return r()(i.a.mark(function t(){var a,s,n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={deviceTypeId:e.deviceId},t.next=3,e.$http.post(e.$api.devicetypedetail,a);case 3:if(1e4==(s=t.sent).data.resultCode){if(e.typeName=s.data.data.deviceTypeName,e.typeCode=s.data.data.deviceTypeCode,e.selectDefault=s.data.data.serviceTypeName,e.remark=s.data.data.remark,e.brandList=s.data.data.deviceBrandList,e.brandList.length>0)for(e.selectedRowKeys=[],e,n=0;n<e.brandList.length;n++)e.brandList[n].select&&e.selectedRowKeys.push(n)}else e.$message.error(s.data.resultMsg);case 5:case"end":return t.stop()}},t,e)}))()},getBrandData:function(){var e=this;return r()(i.a.mark(function t(){var a,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={pageIndex:1,pageSize:200,keyword:""},t.next=3,e.$http.post(e.$api.devicebrandspage,a);case 3:1e4==(s=t.sent).data.resultCode&&(e.brandList=s.data.data.list);case 5:case"end":return t.stop()}},t,e)}))()},getCombobox:function(){var e=this;return r()(i.a.mark(function t(){var a,s,n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={classCode:"device_service_type"},t.next=3,e.$http.post(e.$api.dictionarycombobox,a);case 3:for(s=t.sent,n=0;n<s.data.data.length;n++)e.selectList=s.data.data;console.log(s);case 6:case"end":return t.stop()}},t,e)}))()},onSelectChange:function(e){this.selectedRowKeys=e},submit:function(){var e=this;return r()(i.a.mark(function t(){var a,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.typeName){t.next=3;break}return e.$message.warning("类型名称不能为空"),t.abrupt("return");case 3:if(e.typeCode){t.next=6;break}return e.$message.warning("类型代码不能为空"),t.abrupt("return");case 6:if("请选择业务类别"!=e.selectDefault){t.next=9;break}return e.$message.warning("请选择业务类别"),t.abrupt("return");case 9:if(!(e.selectedRowKeys.length<=0)){t.next=12;break}return e.$message.warning("请关联设备品牌"),t.abrupt("return");case 12:return a={deviceTypeId:e.deviceId,deviceTypeName:e.typeName,deviceTypeCode:e.typeCode,serviceType:e.getServiceType(),operatorId:JSON.parse(localStorage.getItem("usermsg")).accountId,remark:e.remark,deviceBrandList:e.getdeviceBrand()},t.next=15,e.$http.post(e.$api.devicetypeform,a);case 15:1e4==(s=t.sent).data.resultCode?(e.deviceId||e.$router.go(-1),e.$message.success(s.data.resultMsg)):e.$message.error(s.data.resultMsg);case 17:case"end":return t.stop()}},t,e)}))()},getdeviceBrand:function(){for(var e=[],t=0;t<this.selectedRowKeys.length;t++)e.push(this.brandList[this.selectedRowKeys[t]].brandId);return e},handleSelectChange:function(e){console.log(e),this.serviceType=e,this.selectDefault=e},getServiceType:function(){for(var e=void 0,t=0;t<this.selectList.length;t++)if(this.selectList[t].comboBoxName==this.selectDefault){e=this.selectList[t].comboBoxId;break}return e}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flexcolumn",staticStyle:{"background-color":"#FFFFFF"}},[a("div",{staticStyle:{margin:"0 auto"}},[a("div",{staticClass:"flexrow flexac select_item_types_email"},[e._m(0),e._v(" "),a("div",{staticClass:"edit_a_input_types"},[a("a-input",{attrs:{placeholder:"平台"},model:{value:e.typeName,callback:function(t){e.typeName=t},expression:"typeName"}})],1),e._v(" "),a("div",{staticClass:"select_item_types_email_toast"},[e._v("注：50字以内，中文汉字、英文字母、数字、英文下划线、中英文小括号")])]),e._v(" "),a("div",{staticClass:"flexrow flexac select_item_types_email"},[e._m(1),e._v(" "),a("div",{staticClass:"edit_a_input_types"},[a("a-input",{attrs:{placeholder:"50字以内，中文汉字、英文字母、数字、英文下划线、中英文小括号"},model:{value:e.typeCode,callback:function(t){e.typeCode=t},expression:"typeCode"}})],1),e._v(" "),a("div",{staticClass:"select_item_types_email_toast"},[e._v("注：50字以内，中文汉字、英文字母、数字、英文下划线、中英文小括号")])]),e._v(" "),a("div",{staticClass:"flexrow flexac select_item_types_email"},[e._m(2),e._v(" "),a("a-select",{staticStyle:{width:"667px"},attrs:{value:e.selectDefault},on:{change:e.handleSelectChange}},e._l(e.selectList,function(t,s){return a("a-select-option",{key:s,attrs:{value:t.comboBoxName}},[e._v("\n          "+e._s(t.comboBoxName)+"\n        ")])}),1),e._v(" "),a("div",{staticClass:"select_item_types_email_toast"},[e._v("注：数字字典")])],1),e._v(" "),a("div",{staticClass:"flexrow flexac select_item_types_email"},[a("div",{staticClass:"select_item_types_email_title3"},[e._v("类型描述:")]),e._v(" "),a("div",{staticStyle:{position:"relative",width:"667px"}},[a("a-textarea",{staticClass:"edit_a_input_types",attrs:{rows:5,maxLength:250,placeholder:"请输入描述"},on:{change:e.onChangeConfig},model:{value:e.remark,callback:function(t){e.remark=t},expression:"remark"}}),e._v(" "),a("div",{staticClass:"edit_number"},[e._v(e._s(e.num)+"/250")])],1)]),e._v(" "),a("div",{staticClass:"flexrow select_item_types_email_title3",staticStyle:{"margin-top":"40px","justify-item":"flex-start","margin-bottom":"10px","font-size":"16px"}},[e._v("设备品牌")]),e._v(" "),a("a-table",{attrs:{columns:e.dictionaryColumns,"data-source":e.brandList,pagination:!1,bordered:!0,size:"small","row-selection":{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},scopedSlots:e._u([{key:"index",fn:function(t,a,s){return[e._v("\n        "+e._s(s+1)+"\n      ")]}}])}),e._v(" "),a("div",{staticClass:"flexrow flexjc",staticStyle:{"margin-top":"30px","margin-bottom":"100px"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("保存")]),e._v(" "),a("a-button",{staticStyle:{"margin-left":"60px"}},[e._v("重置")])],1)],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"select_item_types_email_title3"},[t("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("类型名称:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"select_item_types_email_title3"},[t("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("类型代码:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"select_item_types_email_title3"},[t("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("业务类别:")])}]};var p=a("VU/8")(o,d,!1,function(e){a("kJnm")},null,null);t.default=p.exports},kJnm:function(e,t){},zLZ9:function(e,t){e.exports={data:{dictionaryColumns:[{title:"序号",width:"80px",align:"center",ellipsis:!0,scopedSlots:{customRender:"index"}},{title:"类型名称",align:"center",dataIndex:"deviceTypeName",ellipsis:!0},{title:"类型代码",align:"center",dataIndex:"deviceTypeCode",ellipsis:!0},{title:"业务类别",align:"center",dataIndex:"serviceTypeName",ellipsis:!0},{title:"品牌数量",align:"center",dataIndex:"brandTotal",ellipsis:!0},{title:"型号数量",align:"center",dataIndex:"modelTotal",ellipsis:!0},{title:"操作",align:"center",width:"360px",scopedSlots:{customRender:"operation"}}],adddictionaryColumns:[{title:"序号",width:"80px",align:"center",scopedSlots:{customRender:"index"}},{title:"品牌名称",dataIndex:"brandName",align:"center"},{title:"品牌代码",dataIndex:"brandCode",align:"center"}],attList:[{title:"序号",width:"3%",align:"center",scopedSlots:{customRender:"index"}},{title:"属性名称",dataIndex:"propertyName",align:"center",width:"15%",scopedSlots:{customRender:"propertyName"}},{title:"属性代码",dataIndex:"propertyCode",align:"center",width:"15%",scopedSlots:{customRender:"propertyCode"}},{title:"属性描述",dataIndex:"propertyDesc",align:"center",width:"40%",scopedSlots:{customRender:"propertyDesc"}},{title:"操作",dataIndex:"brandCode",align:"center",width:"25%",scopedSlots:{customRender:"operation"}}]}}}});