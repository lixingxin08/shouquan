webpackJsonp([58],{CkgR:function(e,t){},KcpM:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Xxa5"),i=a.n(s),r=a("exGp"),n=a.n(r),c={components:{isLeft:a("vP0l").a},data:function(){return{selectValue:"",selectList:[{menuId:"",menuName:"全部"}],config:{},id:"",treedata:"",replaceFields:{title:"name",key:"id"},defaultExpandedKeys:[],data:"",showtree:!1,num:0}},created:function(){this.id=this.$route.query.id,this.id&&this.getDetail(),this.getCombobox(),this.gettree()},methods:{submit:function(){var e=this;return n()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.config.roleName){t.next=3;break}return e.$message.warning("角色名称不能为空"),t.abrupt("return");case 3:if(!(e.defaultExpandedKeys.length<=0)){t.next=6;break}return e.$message.warning("请配置角色权限"),t.abrupt("return");case 6:return e.config.menuIdList=e.defaultExpandedKeys,e.config.operatorId="5172dadd6d7c404e8ac657f32f81d969",t.next=10,e.$http.post(e.$api.rolesystemform,e.config);case 10:1e4==(a=t.sent).data.resultCode?e.$message.success(a.data.resultMsg):e.$message.error(a.data.resultMsg);case 12:case"end":return t.stop()}},t,e)}))()},getDetail:function(){var e=this;return n()(i.a.mark(function t(){var a,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={roleId:e.id},t.next=3,e.$http.post(e.$api.rolesystemdetail,a);case 3:1e4==(s=t.sent).data.resultCode&&(e.config=s.data.data);case 5:case"end":return t.stop()}},t,e)}))()},handleSelectChange:function(e){this.selectValue=e,this.gettree()},getCombobox:function(){var e=this;return n()(i.a.mark(function t(){var a,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={},t.next=3,e.$http.post(e.$api.rolesystemrolelist,a);case 3:1e4==(s=t.sent).data.resultCode&&(e.selectList=e.selectList.concat(s.data.data));case 5:case"end":return t.stop()}},t,e)}))()},reset:function(){this.id?(this.getDetail(),this.gettree()):(this.defaultExpandedKeys=[],this.config={})},onChangeConfig:function(){this.num=this.config.remark.length},gettree:function(){var e=this;return n()(i.a.mark(function t(){var a,s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.showtree=!1,a={systemId:e.selectValue?e.selectValue.substring(0,3):"",roleId:e.id},t.next=4,e.$http.post(e.$api.rolesystemroletreelist,a);case 4:"10000"==(s=t.sent).data.resultCode?e.data=s.data.data:e.$message.error(s.data.resultMsg),e.setdata(),e.showtree=!0;case 8:case"end":return t.stop()}},t,e)}))()},toTree:function(e){var t=[];if(!Array.isArray(e))return t;e.forEach(function(e){delete e.children});var a={};return e.forEach(function(e){a[e.id]=e}),e.forEach(function(e){var s=a[e.pid];s?(s.children||(s.children=[])).push(e):t.push(e)}),t},setdata:function(){for(var e=0;e<this.data.length;e++)this.data[e].checked&&this.defaultExpandedKeys.push(this.data[e].id);this.treedata=this.toTree(this.data),console.log(this.defaultExpandedKeys)},getsearchdata:function(e){this.issearchdata=e,this.getareatree(),""!=e&&(this.filterdata=[],this.setfilltertree(this.treedata,this.issearchdata))},setfilltertree:function(e,t){for(var a in e){-1!=(e[a].name+"").search(this.issearchdata)&&this.filterdata.push(e[a]),e[a].children&&this.setfilltertree(e[a].children)}this.treedata=this.toTree(this.filterdata)},getselectdata:function(e){this.isselectdata=e,this.isselectdata.id=e.id,this.isselectdata.name=e.name,this.isselectdata.pid=e.pid,this.istotal.type=1},getcheckedKeys:function(e){console.log("----------",e),this.defaultExpandedKeys=e}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flexcolumn",staticStyle:{"background-color":"#FFFFFF"}},[a("div",{staticStyle:{margin:"0 auto"}},[a("div",{staticClass:"flexrow flexac edit_item_zzx"},[e._m(0),e._v(" "),a("a-input",{staticClass:"edit_a_input_zzx",attrs:{maxLength:50,placeholder:"2-16个字，支持中英文"},model:{value:e.config.roleName,callback:function(t){e.$set(e.config,"roleName",t)},expression:"config.roleName"}})],1),e._v(" "),a("div",{staticClass:"flexrow flexac edit_item_zzx"},[a("div",{staticClass:"edit_item_zzx_title1_zzx"},[e._v("角色描述:")]),e._v(" "),a("a-input",{staticClass:"edit_a_input_zzx",attrs:{placeholder:"500字以内，格式不限制"},model:{value:e.config.remark,callback:function(t){e.$set(e.config,"remark",t)},expression:"config.remark"}})],1),e._v(" "),a("div",{staticClass:"flexrow flexac edit_item_zzx",staticStyle:{"align-items":"flex-start"}},[e._m(1),e._v(" "),a("div",{staticClass:"flexcolumn selet_bg_zzx"},[a("div",{staticClass:"flexrow  flexac"},[a("div",{staticStyle:{"flex-shrink":"0","margin-right":"7px",width:"100px","text-align":"end","font-size":"14px"}},[e._v("\n            服务子系统:\n          ")]),e._v(" "),a("a-select",{staticClass:"selet_bg_zzx",attrs:{value:e.selectValue?e.selectValue:"全部"},on:{change:e.handleSelectChange}},e._l(e.selectList,function(t,s){return a("a-select-option",{key:s,attrs:{value:t.menuId}},[e._v("\n              "+e._s(t.menuName)+"\n            ")])}),1)],1),e._v(" "),a("div",{staticClass:"tree_box_zzx"},[e.showtree?a("is-left",{attrs:{treedata:e.treedata,replaceFields:e.replaceFields,checkedKeys:e.defaultExpandedKeys},on:{checkedKeys:e.getcheckedKeys}}):e._e()],1)])]),e._v(" "),a("div",{staticClass:"flexrow flexjc",staticStyle:{"margin-top":"60px","margin-bottom":"100px"}},[a("a-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("保存")]),e._v(" "),a("a-button",{staticStyle:{"margin-left":"60px"},on:{click:e.reset}},[e._v("重置")])],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"edit_item_zzx_title1_zzx"},[t("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("角色名称:")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"edit_item_zzx_title1_zzx"},[t("a",{staticStyle:{color:"#FF0000"}},[this._v("*")]),this._v("角色权限配置:")])}]};var o=a("VU/8")(c,l,!1,function(e){a("CkgR")},null,null);t.default=o.exports}});