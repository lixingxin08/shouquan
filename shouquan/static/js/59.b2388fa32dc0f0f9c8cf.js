webpackJsonp([59],{T94K:function(t,e){},USjU:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n=a("bOdI"),s=a.n(n),r=a("Xxa5"),d=a.n(r),l=a("exGp"),o=a.n(l),c=a("c/w/"),p=a("wxRv"),u={components:{isLeft:c.a,isDeleteDialog:p.a},data:function(){return{ModalText:"您确定要删除吗？",visible:!1,showtree:!1,treedata:null,tabletype:!1,inp_data:"",isselectdata:{id:"",name:"",pid:""},replaceFields:{title:"name",key:"id"},tablecolumns:[{width:110,align:"center",title:"序号",dataIndex:"departmentId",key:"departmentId",ellipsis:!0,scopedSlots:{customRender:"index"}},{width:100,align:"center",title:"部门名称",dataIndex:"departmentName",key:"departmentName",ellipsis:!0},{width:208,align:"center",title:"上级部门名称",dataIndex:"parentName",key:"parentName",ellipsis:!0},{width:208,align:"center",title:"直属员工数量",key:"personTotal",dataIndex:"personTotal",ellipsis:!0},{width:108,align:"center",title:"操作",ellipsis:!0,key:"2",dataIndex:"childTotal",scopedSlots:{customRender:"edit"}}],tabledata:"",defaultExpandedKeys:[],data:"",pagination:{total:0,pageSize:10,showSizeChanger:!0,current:1,page:1,pageSizeOptions:["10","20","50","100"],showTotal:function(t){return"共有 "+t+" 条数据"}},issearchdata:"",filterdata:[],departmenttreeprame:{customerId:"",departmentId:"",operatorId:JSON.parse(localStorage.getItem("usermsg")).accountId},removeparam:{departmentId:""},istotal:{type:1}}},created:function(){this.getdepartmenttree()},methods:(i={getdepartmenttree:function(){var t=this;return o()(d.a.mark(function e(){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.showtree=!1,e.next=3,t.$http.post(t.$api.departmenttree,t.departmenttreeprame);case 3:"10000"==(a=e.sent).data.resultCode?t.data=a.data.data:t.$message.error(a.data.resultMsg),t.setdata(),t.showtree=!0,t.getpage();case 8:case"end":return e.stop()}},e,t)}))()},getpage:function(){var t=this;return o()(d.a.mark(function e(){var a,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.tabletype=!1,a={departmentId:t.isselectdata.id,keyword:t.inp_data,pageIndex:t.pagination.page,pageSize:t.pagination.pageSize},e.next=4,t.$http.post(t.$api.departmentpage,a);case 4:"10000"==(i=e.sent).data.resultCode?(t.tabledata=i.data.data.list,1==t.istotal.type&&(t.pagination.total=i.data.data.length),t.istotal.type++,t.tabletype=!0):t.$message.error(i.data.resultMsg);case 6:case"end":return e.stop()}},e,t)}))()},getremove:function(){var t=this;return o()(d.a.mark(function e(){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.post(t.$api.departmentdeleteByDepartmentId,t.removeparam);case 2:"10000"==(a=e.sent).data.resultCode?(t.$message.success(a.data.resultMsg),t.getpage(),t.visible=!1):t.$message.error(a.data.resultMsg);case 4:case"end":return e.stop()}},e,t)}))()},confirm:function(){this.visible=!1},toadd:function(t,e){"add"==t?(""==this.isselectdata.id&&(this.isselectdata.id=this.treedata[0].id,this.isselectdata.name=this.treedata[0].name,this.isselectdata.levelType=this.treedata[0].levelType),this.$router.push({path:"/adddpartmentManagement",query:{type:t,id:this.isselectdata.id,name:this.isselectdata.name,levelType:this.isselectdata.levelType}})):this.$router.push({path:"/adddpartmentManagement",query:{type:t,id:e.departmentId}})},toTree:function(t){var e=[];if(!Array.isArray(t))return e;t.forEach(function(t){delete t.children});var a={};return t.forEach(function(t){a[t.id]=t}),t.forEach(function(t){var i=a[t.pid];i?(i.children||(i.children=[])).push(t):e.push(t)}),e},setdata:function(){for(var t=0;t<this.data.length;t++)1==this.data[t].open&&this.defaultExpandedKeys.push(this.data[t].id);this.treedata=this.toTree(this.data)},getsearchdata:function(t){this.issearchdata=t,this.getdepartmenttree(),""!=t&&(this.filterdata=[],this.setfilltertree(this.treedata,this.issearchdata))},setfilltertree:function(t,e){for(var a in t){-1!=(t[a].name+"").search(this.issearchdata)&&this.filterdata.push(t[a]),t[a].children&&this.setfilltertree(t[a].children)}this.treedata=this.toTree(this.filterdata)},getselectdata:function(t){this.isselectdata=t,this.istotal.type=1,this.getpage()},tosearch:function(){this.istotal.type=1,this.pagination.page=1,this.pagination.pageSize=10,this.getpage()},clear:function(){this.isselectdata.name="",this.inp_data=""},showdialogdpart:function(t){console.log(t,221212),this.removeparam.departmentId=t.departmentId,this.visible=!0},cancel:function(){this.visible=!1}},s()(i,"confirm",function(){this.getremove()}),s()(i,"handleCancel",function(t){console.log("Clicked cancel button"),this.visible=!1}),s()(i,"handleTableChange",function(t){this.pagination.page=t.current,this.pagination.current=t.current,this.pagination.pageSize=t.pageSize,this.getpage()}),i)},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"administrativedivision"},[a("div",{staticClass:"flex_fs"},[a("div",{staticClass:"isleft"},[t.showtree?a("is-left",{attrs:{treedata:t.treedata,replaceFields:t.replaceFields,defaultExpandedKeys:t.defaultExpandedKeys},on:{selectdata:t.getselectdata,searchdata:t.getsearchdata}}):t._e()],1),t._v(" "),a("div",[a("div",{staticClass:"right"},[a("div",{staticClass:"r_top flex_f"},[a("div",{staticClass:"r_t_text",on:{click:function(e){return t.showdialogdpart()}}},[t._v("部门名称")]),t._v(" "),a("a-input",{staticClass:"r_t_inp",attrs:{placeholder:"请输入部门名称"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.tosearch()}},model:{value:t.inp_data,callback:function(e){t.inp_data=e},expression:"inp_data"}}),t._v(" "),a("div",{staticClass:"btn_blue btn",on:{click:function(e){return t.tosearch()}}},[t._v("查询")]),t._v(" "),a("div",{staticClass:"btn_gray",on:{click:function(e){return t.clear()}}},[t._v("清除")])],1),t._v(" "),a("div",{staticClass:"isline"}),t._v(" "),a("div",{staticClass:"btn_blue btn2",on:{click:function(e){return t.toadd("add")}}},[t._v("新增")]),t._v(" "),t.tabletype?a("div",{staticClass:"table"},[a("a-table",{attrs:{columns:t.tablecolumns,"data-source":t.tabledata,bordered:"",pagination:t.pagination},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"index",fn:function(e,a,i){return[t._v(t._s(i+1+10*(t.pagination.current-1)))]}},{key:"edit",fn:function(e,i){return a("div",{staticClass:"flex_a"},[a("div",{staticClass:"col_blue ispointer",on:{click:function(e){return t.toadd("edit",i)}}},[t._v("编辑")]),t._v(" "),0==i.personTotal?a("div",{staticClass:"col_red ispointer",on:{click:function(e){return t.showdialogdpart(i)}}},[a("span",[t._v("删除")])]):t._e(),t._v(" "),0!==i.personTotal?a("div",{staticClass:"col_gray ispointer"},[t._v("删除")]):t._e()])}}],null,!1,353840059)})],1):t._e()])])]),t._v(" "),t.visible?a("is-delete-dialogdpart",{on:{confirm:t.confirm,cancle:t.cancel}}):t._e()],1)},staticRenderFns:[]};var f=a("VU/8")(u,h,!1,function(t){a("T94K")},"data-v-1290a180",null);e.default=f.exports}});