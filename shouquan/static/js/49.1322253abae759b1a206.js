webpackJsonp([49],{Logu:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),s=a.n(r),i=a("exGp"),n=a.n(i),d={components:{isLeft:a("vP0l").a},data:function(){return{sel_data:"",form:{templateId:"",templateName:"",statusCode:"",remark:"",menuList:[],operatorId:"1"},replaceFields:{title:"name",key:"id"},defaultExpandedKeys:[],checkedKeys:[],treedata:"",oldtreedata:"",detailparam:{templateId:""},data:"",showtree:!1,statusCode:[{id:1,val:"启用"},{id:"0",val:"关闭"}],islist:[],treeprame:{templateId:""}}},computed:{isdefaultChecked:function(){return 0!=this.form.defaultChecked}},created:function(){"edit"==this.$route.query.type?(this.detailparam.templateId=this.$route.query.id,this.getdetail()):this.gettree()},methods:{gettree:function(){var e=this;return n()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.showtree=!1,t.next=3,e.$http.post(e.$api.templatetree,e.treeprame);case 3:"10000"==(a=t.sent).data.resultCode&&(e.data=a.data.data),e.setdata(),e.showtree=!0,e.oldtreedata=e.treedata,console.log(e.treedata,6555555);case 9:case"end":return t.stop()}},t,e)}))()},getdetail:function(){var e=this;return n()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.showtree=!1,t.next=3,e.$http.post(e.$api.templatedetail,e.detailparam);case 3:if("10000"!=(a=t.sent).data.resultCode){t.next=11;break}e.form=a.data.data,e.data=e.form.menuTree,e.setdata(),e.showtree=!0,t.next=12;break;case 11:return t.abrupt("return",e.$message.error(a.data.resultMsg));case 12:console.log(a,8888);case 13:case"end":return t.stop()}},t,e)}))()},getform:function(){var e=this;return n()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.vify_cn(e.form.templateName)){t.next=3;break}return e.form.templateName="",t.abrupt("return",e.$message.error("模板名称格式不正确"));case 3:if(""!=e.form.templateName){t.next=5;break}return t.abrupt("return",e.$message.error("请输入模板名称"));case 5:if(""!=e.form.statusCode){t.next=7;break}return t.abrupt("return",e.$message.error("请选择模板状态"));case 7:if(""!=e.form.menuList){t.next=9;break}return t.abrupt("return",e.$message.error("请选择权限配置"));case 9:return e.form.operatorId=1,t.next=12,e.$http.post(e.$api.templateform,e.form);case 12:if("10000"!=(a=t.sent).data.resultCode){t.next=18;break}e.$message.success(a.data.resultMsg),e.$router.go(-1),t.next=19;break;case 18:return t.abrupt("return",e.$message.error(a.data.resultMsg));case 19:case"end":return t.stop()}},t,e)}))()},reset:function(){this.$router.go(0)},handleChange:function(e,t){console.log(this.form.typeCode,88)},handleChange2:function(e,t){if(console.log(this.treeprame.templateId,88),this.showtree=!1,this.treedata=this.oldtreedata,"all"==this.treeprame.templateId)this.treedata=this.oldtreedata;else{for(var a="",r=0;r<this.treedata.length;r++)this.treedata[r].id==this.treeprame.templateId&&(a=this.treedata[r]);this.treedata=Array(a)}this.showtree=!0},toTree:function(e){var t=[];if(!Array.isArray(e))return t;e.forEach(function(e){delete e.children});var a={};return e.forEach(function(e){a[e.id]=e}),e.forEach(function(e){var r=a[e.pid];r?(r.children||(r.children=[])).push(e):t.push(e)}),t},setdata:function(){this.form.menuList=[];for(var e=0;e<this.data.length;e++)this.form.menuList.push(this.data[e].id),1==this.data[e].open&&this.defaultExpandedKeys.push(this.data[e].id),1==this.data[e].checked&&this.checkedKeys.push(this.data[e].id);this.treedata=this.toTree(this.data)},getsearchdata:function(e){this.issearchdata=e,this.getareatree(),""!=e&&(this.filterdata=[],this.setfilltertree(this.treedata,this.issearchdata))},setfilltertree:function(e,t){for(var a in e){-1!=(e[a].name+"").search(this.issearchdata)&&this.filterdata.push(e[a]),e[a].children&&this.setfilltertree(e[a].children)}this.treedata=this.toTree(this.filterdata)},getselectdata:function(e){this.isselectdata=e,this.isselectdata.id=e.id,this.isselectdata.name=e.name,this.isselectdata.pid=e.pid,this.istotal.type=1},getcheckedKeys:function(e){this.form.menuList=e,console.log(e,44444)}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"isedit"},[a("div",{staticClass:"flexrow flexac edit_item"},[e._m(0),e._v(" "),a("div",[a("a-input",{staticClass:"edit_a_input",attrs:{maxLength:30,placeholder:"请输入模板名称"},model:{value:e.form.templateName,callback:function(t){e.$set(e.form,"templateName",t)},expression:"form.templateName"}})],1),e._v(" "),a("div",{staticClass:"edit_item_toast"},[e._v("注:中英文，30字以内")])]),e._v(" "),a("div",{staticClass:"flexrow flexac edit_item"},[e._m(1),e._v(" "),a("a-select",{staticStyle:{width:"667px","margin-right":"20px",height:"36px","border-radius":"8px"},attrs:{placeholder:"请选择","option-filter-prop":"children"},on:{change:e.handleChange},model:{value:e.form.statusCode,callback:function(t){e.$set(e.form,"statusCode",t)},expression:"form.statusCode"}},e._l(e.statusCode,function(t,r){return a("a-select-option",{key:r,attrs:{value:t.id}},[e._v(e._s(t.val))])}),1)],1),e._v(" "),a("div",{staticClass:"flexrow flexac edit_item"},[a("div",{staticClass:"edit_item_title"},[e._v("模板描述:")]),e._v(" "),a("div",{staticStyle:{position:"relative"}},[a("a-textarea",{staticClass:"edit_a_input",attrs:{rows:5,placeholder:"500字以内，格式不限制"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)]),e._v(" "),a("div",{staticClass:"flexrow flexac edit_item"},[a("div",{staticClass:"edit_item_title"},[e._v("模板描述:")]),e._v(" "),a("div",{staticStyle:{position:"relative"}},[a("div",{staticClass:"templatetree edit_item_tree"},[a("div",{staticClass:"flex_f templatetree_sel"},[a("span",[e._v("服务子系统：")]),e._v(" "),a("div",[e.showtree?a("a-select",{staticStyle:{width:"200px","margin-right":"20px",height:"36px","border-radius":"8px"},attrs:{"show-search":"",placeholder:"全部","option-filter-prop":"children"},on:{change:e.handleChange2},model:{value:e.treeprame.templateId,callback:function(t){e.$set(e.treeprame,"templateId",t)},expression:"treeprame.templateId"}},[a("a-select-option",{attrs:{value:"all"}},[e._v("全部")]),e._v(" "),e._l(e.oldtreedata,function(t,r){return a("a-select-option",{key:r,attrs:{value:t.id}},[e._v(e._s(t.name))])})],2):e._e()],1)]),e._v(" "),a("div",[e.showtree?a("is-left",{attrs:{treedata:e.treedata,replaceFields:e.replaceFields,defaultExpandedKeys:e.defaultExpandedKeys,checkedKeys:e.checkedKeys,selectable:!0},on:{checkedKeys:e.getcheckedKeys,selectdata:e.getselectdata}}):e._e()],1)])])]),e._v(" "),a("div",{staticClass:"flexrow",staticStyle:{"margin-top":"30px","justify-item":"flex-start","margin-left":"325px"}},[a("a-button",{on:{click:function(t){return e.getform()}}},[e._v("保存")]),e._v(" "),a("a-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:function(t){return e.reset()}}},[e._v("重置")])],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"edit_item_title"},[t("span",{staticClass:"col_red"},[this._v("*")]),this._v("模板名称:\n    ")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"edit_item_title"},[t("span",{staticClass:"col_red"},[this._v("*")]),this._v("模板状态:\n    ")])}]};var o=a("VU/8")(d,l,!1,function(e){a("MGHj")},null,null);t.default=o.exports},MGHj:function(e,t){}});