webpackJsonp([8],{"9rDm":function(e,t,a){"use strict";var s={data:function(){return{showLine:!0,showIcon:!0,olddata:"",oldcheck:""}},props:{treedata:Array,checkable:{type:Boolean,default:!0},replaceFields:Object,defaultExpandedKeys:Array,checkedKeys:Array},created:function(){},methods:{onSelect:function(e,t){if(this.checkedKeys.includes(e[0]))for(var a=0;a<this.checkedKeys.length;a++)this.checkedKeys[a]==e[0]&&(console.log(a,0x3f28cb71571c7),this.checkedKeys.splice(a,1),this.oldcheck=e[0]);else this.checkedKeys.push(e[0]);0==e.length&&this.checkedKeys.push(this.oldcheck),0!=t.selected&&(this.olddata=t.selectedNodes[0].data.props,this.$emit("selectdata",t.selectedNodes[0].data.props||""))},onSearch:function(e){console.log(e,88292),this.$emit("searchdata",e)},onCheck:function(e,t){console.log("onCheck",e,t),this.checkedKeys=e}}},r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"search"},[t("div",{staticClass:"istree"},[t("a-tree",{attrs:{"show-line":this.showLine,checkable:this.checkable,"tree-data":this.treedata,replaceFields:this.replaceFields,"checked-keys":this.checkedKeys,selectable:!1,"default-expanded-keys":this.defaultExpandedKeys},on:{check:this.onCheck}},[t("a-icon",{attrs:{slot:"icon",type:"carry-out"},slot:"icon"})],1)],1)])},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(e){a("NKtJ")},"data-v-d4c847e4",null);t.a=i.exports},KUWH:function(e,t){},NKtJ:function(e,t){},"srF/":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Xxa5"),r=a.n(s),i=a("exGp"),n=a.n(i),c={inject:["reload"],components:{isLeft:a("9rDm").a},data:function(){var e=this;return{tablecolumns:[{width:58,align:"center",title:"序号",dataIndex:"customerId",key:"customerId",ellipsis:!0},{width:141,align:"center",title:"客户简称",dataIndex:"shortName",key:"shortName",ellipsis:!0},{width:141,align:"center",title:"客户状态",dataIndex:"statusCode",key:"statusCode",ellipsis:!0,scopedSlots:{customRender:"statusCode"}}],tabledata:[],treedata:"",tabletype:!1,tabletype2:!1,replaceFields:{title:"name",key:"id"},defaultExpandedKeys:[],checkedKeys:[],tablecolumns2:[{width:58,align:"center",title:"序号",dataIndex:"templateId",key:"templateId",ellipsis:!0},{width:220,align:"center",title:"模板名称",dataIndex:"templateName",key:"templateName",ellipsis:!0}],tabledata2:[],treedata2:"",replaceFields2:{title:"name",key:"id"},data:"",showtree:!1,listparam:{operatorId:JSON.parse(localStorage.getItem("usermsg")).accountId,customerId:""},pagination:{total:0,pageSize:10,showSizeChanger:!0,current:1,page:1,pageSizeOptions:["10","20","50","100"],showTotal:function(e){return"共有 "+e+" 条数据"}},istotal:{type:1},treeprame:{templateId:""},detailparame:{pageIndex:"",pageSize:""},form:{customerId:"",templateId:"",menuIdList:"",remark:""},rowClick:function(t){return{on:{click:function(){console.log(t,"record"),e.treeprame.templateId=t.templateId,e.gettree()}}}},rowClick2:function(t){return{on:{click:function(){e.form.customerId=t.customerId,console.log(e.form.customerId,"record")}}}}}},created:function(){this.getlist(),this.getdetail(),console.log(localStorage.getItem("user"),111)},methods:{gettree:function(){var e=this;return n()(r.a.mark(function t(){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.showtree=!1,t.next=3,e.$http.post(e.$api.templatetree,e.treeprame);case 3:"10000"==(a=t.sent).data.resultCode&&(e.data=a.data.data),e.setdata(),e.showtree=!0,e.oldtreedata=e.treedata;case 8:case"end":return t.stop()}},t,e)}))()},getlist:function(){var e=this;return n()(r.a.mark(function t(){var a,s;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.tabletype=!1,t.next=3,e.$http.post(e.$api.customeraccountmylist,e.listparam);case 3:if("10000"!=(a=t.sent).data.resultCode){t.next=13;break}for(s=0;s<a.data.data.length;s++)1==a.data.data[s].statusCode&&e.tabledata.push(a.data.data[s]);e.form.customerId=e.tabledata[0].customerId,e.gettree(),1==e.istotal.type&&(e.pagination.total=a.data.data.length),e.istotal.type++,e.tabletype=!0,t.next=14;break;case 13:return t.abrupt("return",e.$message.error(a.data.resultMsg));case 14:case"end":return t.stop()}},t,e)}))()},getdetail:function(){var e=this;return n()(r.a.mark(function t(){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.tabletype2=!1,e.detailparame.pageIndex=e.pagination.page,e.detailparame.pageSize=e.pagination.pageSize,t.next=5,e.$http.post(e.$api.templatelist,e.detailparame);case 5:if("10000"!=(a=t.sent).data.resultCode){t.next=10;break}e.tabledata2=a.data.data,t.next=11;break;case 10:return t.abrupt("return",e.$message.error(a.data.resultMsg));case 11:case"end":return t.stop()}},t,e)}))()},getform:function(){var e=this;return n()(r.a.mark(function t(){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.form.operatorId=1,e.form.menuIdList=e.checkedKeys,""!=e.form.menuIdList&&e.form.menuIdList!=[]){t.next=4;break}return t.abrupt("return",e.$message.error("请选择授权系统"));case 4:return t.next=6,e.$http.post(e.$api.customertemplateform,e.form);case 6:if("10000"!=(a=t.sent).data.resultCode){t.next=11;break}e.$message.success(a.data.resultMsg),t.next=12;break;case 11:return t.abrupt("return",e.$message.error(a.data.resultMsg));case 12:case"end":return t.stop()}},t,e)}))()},toTree:function(e){var t=[];if(!Array.isArray(e))return t;e.forEach(function(e){delete e.children});var a={};return e.forEach(function(e){a[e.id]=e}),e.forEach(function(e){var s=a[e.pid];s?(s.children||(s.children=[])).push(e):t.push(e)}),t},setdata:function(){for(var e=0;e<this.data.length;e++)1==this.data[e].open&&this.defaultExpandedKeys.push(this.data[e].id),1==this.data[e].checked&&this.checkedKeys.push(this.data[e].id);this.treedata=this.toTree(this.data)},getsearchdata:function(e){this.issearchdata=e,this.gettree(),""!=e&&(this.filterdata=[],this.setfilltertree(this.treedata,this.issearchdata))},setfilltertree:function(e,t){for(var a in e){-1!=(e[a].name+"").search(this.issearchdata)&&this.filterdata.push(e[a]),e[a].children&&this.setfilltertree(e[a].children)}this.treedata=this.toTree(this.filterdata)},getselectdata:function(e){this.isselectdata=e,this.isselectdata.id=e.id,this.isselectdata.name=e.name,this.isselectdata.pid=e.pid,this.istotal.type=1},getcheckedKeys:function(e){console.log(e,44444),this.form.menuIdList=e},handleChange2:function(e,t){if(console.log(e,t),this.showtree=!1,this.treedata=this.oldtreedata,"all"==e);else{for(var a="",s=0;s<this.treedata.length;s++)this.treedata[s].id==e&&(a=this.treedata[s]);this.treedata=Array(a)}this.showtree=!0,console.log(this.checkedKeys,5544444)},cancel:function(){this.reload()}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"flex_f father"},[a("div",{staticClass:"isleft"},[a("div",{staticClass:"left_title"},[e._v("客户列表")]),e._v(" "),a("a-table",{attrs:{columns:e.tablecolumns,"data-source":e.tabledata,bordered:"",pagination:!1,customRow:e.rowClick2},scopedSlots:e._u([{key:"statusCode",fn:function(t){return a("div",{staticClass:"flex_a"},[1==t?a("div",[e._v("启用")]):e._e(),e._v(" "),2==t?a("div",[e._v("备用")]):e._e(),e._v(" "),0==t?a("div",[e._v("关闭")]):e._e()])}}])})],1),e._v(" "),a("div",{staticClass:"isright"},[a("div",{staticClass:"tree_boxmenu flex_f"},[a("div",{staticClass:"tree_box_i tree_box_i_l"},[a("div",{staticClass:"left_title"},[e._v("选择授权模板")]),e._v(" "),a("div",{staticClass:"isscroll"},[a("a-table",{attrs:{columns:e.tablecolumns2,"data-source":e.tabledata2,bordered:"",customRow:e.rowClick}})],1)]),e._v(" "),a("div",{staticClass:"tree_box_i tree_box_i_r"},[a("div",{staticClass:"flex_f templatetree_sel"},[a("span",[e._v("服务子系统：")]),e._v(" "),a("div",[e.showtree?a("a-select",{staticStyle:{width:"200px","margin-right":"20px",height:"36px","border-radius":"8px"},attrs:{"show-search":"",placeholder:"全部","option-filter-prop":"children"},on:{change:e.handleChange2}},[a("a-select-option",{attrs:{value:"all"}},[e._v("全部")]),e._v(" "),e._l(e.oldtreedata,function(t,s){return a("a-select-option",{key:s,attrs:{value:t.id}},[e._v(e._s(t.name))])})],2):e._e()],1)]),e._v(" "),a("div",{staticClass:"tree_box_i_rtree"},[a("div",{staticClass:"istree_box2"},[e.showtree?a("is-left",{ref:"select",attrs:{treedata:e.treedata,replaceFields:e.replaceFields,defaultExpandedKeys:e.defaultExpandedKeys,checkedKeys:e.checkedKeys},on:{checkedKeys:e.getcheckedKeys}}):e._e()],1)])])]),e._v(" "),a("div",{staticClass:"r_b"},[a("div",{staticClass:"r_b_title"},[e._v("授权描述:")]),e._v(" "),a("div",{staticClass:"rb_text"},[a("a-textarea",{attrs:{placeholder:"Basic usage",rows:5},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),e._v(" "),a("div",{staticClass:"flex_a rb_b"},[a("div",{staticClass:"flex_f"},[a("div",{staticClass:"cancel_btn rb_b_btn",on:{click:function(t){return e.cancel()}}},[e._v("取消")]),e._v(" "),a("div",{staticClass:"ok_btn",on:{click:function(t){return e.getform()}}},[e._v("授权")])])])])])])},staticRenderFns:[]};var l=a("VU/8")(c,d,!1,function(e){a("KUWH")},"data-v-0f59e9d0",null);t.default=l.exports}});